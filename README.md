# åŸºäºåˆ†å­æè¿°ç¬¦çš„å“ˆé‡‘æ–¯å‚æ•°ï¼ˆHuggins Parameterï¼‰QSAR é¢„æµ‹æ¨¡å‹

> æœ¬é¡¹ç›®é€šè¿‡ **QSARï¼ˆå®šé‡æ„æ•ˆå…³ç³»ï¼‰** æ–¹æ³•ï¼Œåˆ©ç”¨åˆ†å­æè¿°ç¬¦å’Œæœºå™¨å­¦ä¹  / æ·±åº¦å­¦ä¹ æ¨¡å‹é¢„æµ‹èšåˆç‰©-æº¶å‰‚ä½“ç³»çš„ **Huggins å‚æ•°ï¼ˆÏ‡ï¼‰**ã€‚

---

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [å®Œæ•´è¿è¡Œæµç¨‹](#å®Œæ•´è¿è¡Œæµç¨‹)
  - [Step 1ï¼šè·å– SMILES åˆ†å­è¡¨ç¤º](#step-1è·å–-smiles-åˆ†å­è¡¨ç¤º)
  - [Step 2ï¼šæ•°æ®é¢„å¤„ç†](#step-2æ•°æ®é¢„å¤„ç†)
  - [Step 3ï¼šç‰¹å¾å·¥ç¨‹](#step-3ç‰¹å¾å·¥ç¨‹)
  - [Step 4ï¼šæ¨¡å‹è®­ç»ƒ](#step-4æ¨¡å‹è®­ç»ƒ)
  - [Step 5ï¼šæ¨¡å‹éªŒè¯ä¸åˆ†æ](#step-5æ¨¡å‹éªŒè¯ä¸åˆ†æ)
- [æ•°æ®æ–‡ä»¶è¯´æ˜](#æ•°æ®æ–‡ä»¶è¯´æ˜)
- [å®éªŒç‰ˆæœ¬ï¼ˆæµ‹è¯•ç›®å½•ï¼‰](#å®éªŒç‰ˆæœ¬æµ‹è¯•ç›®å½•)
- [ä¾èµ–åˆ—è¡¨](#ä¾èµ–åˆ—è¡¨)

---

## é¡¹ç›®ç®€ä»‹

**Huggins å‚æ•°ï¼ˆÏ‡ï¼‰** æ˜¯æè¿°èšåˆç‰©-æº¶å‰‚ç›¸äº’ä½œç”¨çš„å…³é”®çƒ­åŠ›å­¦å‚æ•°ï¼Œå…¶å€¼åæ˜ äº†æ··åˆä½“ç³»ä¸­æº¶å‰‚ä¸èšåˆç‰©ä¹‹é—´çš„äº²å’Œæ€§ã€‚

æœ¬é¡¹ç›®çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼š

1. ä»åŸå§‹æ–‡çŒ®æ•°æ®ä¸­æå–åŒ–åˆç‰©åç§°ï¼Œè½¬æ¢ä¸º **SMILES** åˆ†å­ç»“æ„è¡¨ç¤º
2. åˆ©ç”¨ **RDKit** è®¡ç®—ä¸°å¯Œçš„åˆ†å­æè¿°ç¬¦ï¼ˆQSPR æè¿°ç¬¦ + ç«‹ä½“æè¿°ç¬¦ + åˆ†å­æŒ‡çº¹ç›¸ä¼¼åº¦ï¼‰
3. åŸºäºè¿™äº›æè¿°ç¬¦æ„å»ºæœºå™¨å­¦ä¹ ï¼ˆSklearnï¼‰å’Œæ·±åº¦å­¦ä¹ ï¼ˆDNNï¼‰æ¨¡å‹ï¼Œé¢„æµ‹ Ï‡ å€¼

---

## é¡¹ç›®ç»“æ„

```
Graduation-project/
â”‚
â”œâ”€â”€ è·å–SMILES.py              # Step 1: é€šè¿‡åŒ–åˆç‰©åç§°è·å– SMILES å­—ç¬¦ä¸²
â”œâ”€â”€ æ•°æ®å¤„ç†éƒ¨åˆ†ä»£ç .py          # Step 2: å¤„ç†å“ˆé‡‘æ–¯å‚æ•°ä¸­çš„æµ®åŠ¨å€¼ä¸æ¸©åº¦
â”œâ”€â”€ ç‰¹å¾å·¥ç¨‹.py                 # Step 3: è®¡ç®—åˆ†å­æè¿°ç¬¦ä¸æŒ‡çº¹ç›¸ä¼¼åº¦
â”œâ”€â”€ DNN.py                     # Step 4a: DNN æ·±åº¦ç¥ç»ç½‘ç»œå»ºæ¨¡
â”œâ”€â”€ Sklearn.py                 # Step 4b: Sklearn ä¼ ç»Ÿæœºå™¨å­¦ä¹ å»ºæ¨¡
â”œâ”€â”€ DNN_æ¨¡å‹éªŒè¯.py             # Step 5a: DNN æ¨¡å‹éªŒè¯
â”œâ”€â”€ Sklearn_æ¨¡å‹éªŒè¯.py         # Step 5b: Sklearn æ¨¡å‹éªŒè¯
â”œâ”€â”€ DNNç‰¹å¾è´¡çŒ®åˆ†æ.py          # Step 6a: DNN SHAP ç‰¹å¾è´¡çŒ®åˆ†æ
â”œâ”€â”€ RFç‰¹å¾è´¡çŒ®åˆ†æ.py           # Step 6b: éšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§åˆ†æ
â”‚
â”œâ”€â”€ Huggins.xlsx               # åŸå§‹æ•°æ®ï¼šåŒ–åˆç‰©åç§° + å“ˆé‡‘æ–¯å‚æ•°
â”‚
â”œâ”€â”€ data/                      # ä¸­é—´è¿‡ç¨‹æ•°æ®ï¼ˆæµæ°´çº¿å„æ­¥éª¤äº§ç‰©ï¼‰
â”‚   â”œâ”€â”€ smiles_raw.csv         # Step 1 è¾“å‡ºï¼šå« SMILES çš„åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ smiles_cleaned.xlsx    # æ‰‹åŠ¨æ¸…æ´—åçš„ SMILES æ•°æ®
â”‚   â”œâ”€â”€ huggins_preprocessed.xlsx  # Step 2 è¾“å‡ºï¼šæ¸©åº¦è£‚å˜åçš„é¢„å¤„ç†æ•°æ®
â”‚   â””â”€â”€ molecular_features.xlsx    # Step 3 è¾“å‡ºï¼š28ç»´åˆ†å­æè¿°ç¬¦ç‰¹å¾çŸ©é˜µ
â”‚
â”œâ”€â”€ results/                   # æœ€ç»ˆæˆæœï¼ˆæ¨¡å‹ + éªŒè¯ç»“æœ + å¯è§†åŒ–ï¼‰
â”‚   â”œâ”€â”€ DNN.h5                 # DNN è®­ç»ƒæ¨¡å‹
â”‚   â”œâ”€â”€ DNN_v2.h5 / DNN_v2.keras  # DNN ä¼˜åŒ–ç‰ˆæ¨¡å‹
â”‚   â”œâ”€â”€ fingerprint_model.pkl  # Sklearn æœ€ä¼˜æ¨¡å‹
â”‚   â”œâ”€â”€ DNN_validation_results.xlsx   # DNN éªŒè¯ç»“æœ
â”‚   â”œâ”€â”€ Sklearn_validation_results.xlsx  # Sklearn éªŒè¯ç»“æœ
â”‚   â”œâ”€â”€ DNN_v2_loss.png        # è®­ç»ƒæŸå¤±æ›²çº¿å›¾
â”‚   â”œâ”€â”€ DNN_v2_results.png     # é¢„æµ‹ç»“æœæ•£ç‚¹å›¾
â”‚   â”œâ”€â”€ DNN_SHAP_analysis.png  # Step 6a: DNN SHAP ç‰¹å¾è´¡çŒ®åˆ†æå›¾
â”‚   â””â”€â”€ RF_feature_importance.png  # Step 6b: éšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§å›¾
â”‚
â”œâ”€â”€ requirements.txt           # Python ä¾èµ–æ¸…å•
â”œâ”€â”€ README.md                  # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ æµ‹è¯•/                      # å®éªŒæ€§è„šæœ¬
â”œâ”€â”€ æ¨¡å‹/                      # å†å²æ¨¡å‹å­˜æ¡£
â”œâ”€â”€ å‚è€ƒ/                      # å‚è€ƒä»£ç 
â””â”€â”€ åºŸå¼ƒæ–‡ä»¶å­˜æ¡£/               # å·²å½’æ¡£çš„åºŸå¼ƒæ–‡ä»¶
```

---

## ç¯å¢ƒé…ç½®

### å‰ææ¡ä»¶

- Python 3.8+
- pip åŒ…ç®¡ç†å™¨

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### ä¸»è¦ä¾èµ–

| åº“ | ç”¨é€” |
|---|---|
| `pandas` / `numpy` | æ•°æ®å¤„ç†ä¸ç§‘å­¦è®¡ç®— |
| `rdkit` | åˆ†å­æè¿°ç¬¦è®¡ç®—ã€åˆ†å­æŒ‡çº¹ç”Ÿæˆ |
| `scikit-learn` | ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹ä¸æ•°æ®é¢„å¤„ç† |
| `scikit-optimize` | è´å¶æ–¯è¶…å‚æ•°ä¼˜åŒ–ï¼ˆBayesSearchCVï¼‰ |
| `xgboost` | XGBoost å›å½’æ¨¡å‹ |
| `tensorflow` / `keras` | æ·±åº¦ç¥ç»ç½‘ç»œ (DNN) |
| `matplotlib` | æ•°æ®å¯è§†åŒ– |
| `shap` | æ¨¡å‹å¯è§£é‡Šæ€§åˆ†æï¼ˆSHAP å€¼ï¼‰ |
| `requests` / `tqdm` | ç½‘ç»œè¯·æ±‚ / è¿›åº¦æ¡æ˜¾ç¤º |

> âš ï¸ **æ³¨æ„**ï¼š`rdkit` éœ€è¦é€šè¿‡ conda å®‰è£…ï¼š`conda install -c conda-forge rdkit`

---

## å®Œæ•´è¿è¡Œæµç¨‹

æ•´ä¸ªé¡¹ç›®æŒ‰ä»¥ä¸‹ **5 ä¸ªæ­¥éª¤** ä¾æ¬¡æ‰§è¡Œï¼Œå½¢æˆå®Œæ•´çš„æ•°æ®å¤„ç†â€”å»ºæ¨¡â€”éªŒè¯æµæ°´çº¿ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®Œ æ•´ æµ ç¨‹ å›¾                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Huggins.xlsx (åŸå§‹æ•°æ®)                                        â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚ Step 1: è·å–SMILES â”‚  â†’  SMILES.csv                         â”‚
â”‚  â”‚  (è·å–SMILES.py)   â”‚     (åŒ–åˆç‰©åç§°â†’SMILESåˆ†å­ç»“æ„)          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚  â”‚ Step 2: æ•°æ®é¢„å¤„ç†       â”‚  â†’  processed_and_split_Smiles.xlsxâ”‚
â”‚  â”‚  (æ•°æ®å¤„ç†éƒ¨åˆ†ä»£ç .py)    â”‚     (å¤„ç†Ï‡æµ®åŠ¨å€¼ã€æ¸©åº¦è£‚å˜)         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚ Step 3: ç‰¹å¾å·¥ç¨‹   â”‚  â†’  è®¡ç®—ç»“æœ.xlsx                       â”‚
â”‚  â”‚  (ç‰¹å¾å·¥ç¨‹.py)     â”‚     (åˆ†å­æè¿°ç¬¦ + æŒ‡çº¹ç›¸ä¼¼åº¦ + ç›®æ ‡å€¼)    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚       â”‚                                                         â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚       â–¼                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Step 4a: DNN â”‚   â”‚ Step 4b: ML  â”‚                            â”‚
â”‚  â”‚  (DNN.py)    â”‚   â”‚ (Sklearn.py) â”‚                            â”‚
â”‚  â”‚  â†’ DNN.h5    â”‚   â”‚ â†’ model.pkl  â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚       â”‚                    â”‚                                    â”‚
â”‚       â–¼                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Step 5: æ¨¡å‹éªŒè¯ / ç‰¹å¾è´¡çŒ®åˆ†æ  â”‚                            â”‚
â”‚  â”‚   (æ¨¡å‹éªŒè¯.py / SHAPåˆ†æ)       â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 1ï¼šè·å– SMILES åˆ†å­è¡¨ç¤º

**è„šæœ¬**: [`è·å–SMILES.py`](è·å–SMILES.py)

**åŠŸèƒ½**: å°† `Huggins.xlsx` ä¸­çš„åŒ–åˆç‰©åç§°é€šè¿‡åœ¨çº¿ API è½¬æ¢ä¸º SMILES åˆ†å­ç»“æ„å­—ç¬¦ä¸²ã€‚

**æ•°æ®æµ**: `Huggins.xlsx` â†’ `SMILES.csv`

**æ ¸å¿ƒé€»è¾‘**:

1. è¯»å– `Huggins.xlsx` ä¸­çš„åŒ–åˆç‰©åç§°åˆ—ï¼ˆ`Compound 1`ã€`Compound 2`ï¼‰
2. å¯¹èšåˆç‰©åç§°è¿›è¡Œé¢„å¤„ç†ï¼š
   - å¦‚ `poly(styrene)` â†’ æå–æ‹¬å·å†… `styrene`
   - å¦‚ `polystyrene` â†’ å»é™¤ `poly` å‰ç¼€
3. ä¾æ¬¡é€šè¿‡ä¸¤ä¸ªåœ¨çº¿æ•°æ®åº“æŸ¥è¯¢ SMILESï¼š
   - **ä¸€æ¬¡æŸ¥è¯¢**: PubChem REST API
   - **äºŒæ¬¡æŸ¥è¯¢**ï¼ˆä¸€æ¬¡å¤±è´¥æ—¶ï¼‰: NCI CACTUS æœåŠ¡
4. ä½¿ç”¨çº¿ç¨‹æ± å¹¶å‘æŸ¥è¯¢ï¼ŒåŠ é€Ÿå¤„ç†
5. è¾“å‡ºç»“æœä¿å­˜ä¸º `SMILES.csv`

```bash
python è·å–SMILES.py
```

> âš ï¸ éœ€è¦ç½‘ç»œè¿æ¥ä»¥è®¿é—® PubChem å’Œ NCI æ•°æ®åº“ï¼ŒæŸ¥è¯¢ä¹‹é—´æœ‰éšæœºå»¶è¿Ÿä»¥é¿å…è¢«é™æµ

---

### Step 2ï¼šæ•°æ®é¢„å¤„ç†

**è„šæœ¬**: [`æ•°æ®å¤„ç†éƒ¨åˆ†ä»£ç .py`](æ•°æ®å¤„ç†éƒ¨åˆ†ä»£ç .py)

**åŠŸèƒ½**: å¤„ç†åŸå§‹å“ˆé‡‘æ–¯å‚æ•°æ•°æ®ä¸­çš„å¤æ‚è¡¨è¾¾å¼ï¼ˆå«æµ®åŠ¨å€¼ã€æ¸©åº¦ä¾èµ–é¡¹ï¼‰ï¼Œè®¡ç®—å‡ºç¡®å®šçš„ Ï‡ å€¼ã€‚

**æ•°æ®æµ**: `SMILES.csv`ï¼ˆæ‰‹åŠ¨é‡å‘½åä¸º `Smiles.csv`ï¼‰â†’ `processed_and_split_Smiles.xlsx`

**æ ¸å¿ƒé€»è¾‘**:

1. **Ï‡ è¡¨è¾¾å¼è§£æ** (`process_chi`):
   - å¤„ç†å½¢å¦‚ `0.43+34.7T` çš„æ¸©åº¦ä¾èµ–è¡¨è¾¾å¼ï¼ˆ`T` é¡¹é™¤ä»¥æ¸©åº¦ Kï¼‰
   - å»é™¤è¯¯å·®æ ‡è¯†ï¼ˆ`Â±`ï¼‰å’Œç‰¹æ®Šå­—ç¬¦
   - æ”¯æŒå¤šé¡¹åŠ å‡è¿ç®—
2. **æ¸©åº¦å¤„ç†** (`process_T`):
   - ç¼ºå¤±æ¸©åº¦ â†’ é»˜è®¤ 298.15 K
   - èŒƒå›´æ¸©åº¦ï¼ˆå¦‚ `300-400`ï¼‰â†’ å–å¹³å‡å€¼
3. **æ•°æ®è£‚å˜** (`split_row`):
   - å›ºå®š Ï‡ å€¼ â†’ ç›´æ¥è®¡ç®—
   - å« `T` çš„è¡¨è¾¾å¼ + æ— æ¸©åº¦ â†’ åœ¨ 4 ä¸ªæ ‡å‡†æ¸©åº¦ä¸‹ï¼ˆ0Â°C, 50Â°C, 75Â°C, 100Â°Cï¼‰åˆ†åˆ«è®¡ç®—
   - å« `T` çš„è¡¨è¾¾å¼ + æ¸©åº¦èŒƒå›´ â†’ åœ¨ 4 ä¸ªåˆ†ä½ç‚¹æ¸©åº¦ä¸‹è®¡ç®—
   - å« `T` çš„è¡¨è¾¾å¼ + å›ºå®šæ¸©åº¦ â†’ åœ¨è¯¥æ¸©åº¦ä¸‹è®¡ç®—

```bash
python æ•°æ®å¤„ç†éƒ¨åˆ†ä»£ç .py
```

---

### Step 3ï¼šç‰¹å¾å·¥ç¨‹

**è„šæœ¬**: [`ç‰¹å¾å·¥ç¨‹.py`](ç‰¹å¾å·¥ç¨‹.py)

**åŠŸèƒ½**: åŸºäº SMILES å­—ç¬¦ä¸²è®¡ç®— 28 ç»´åˆ†å­æè¿°ç¬¦ç‰¹å¾ï¼Œç”¨äºåç»­å»ºæ¨¡ã€‚

**æ•°æ®æµ**: `processed_and_split_Smiles.xlsx` â†’ `è®¡ç®—ç»“æœ.xlsx`

**æ ¸å¿ƒé€»è¾‘**:

å¯¹æ¯ä¸€å¯¹åŒ–åˆç‰©ï¼ˆCompound 1 + Compound 2ï¼‰ï¼Œåˆ©ç”¨ **RDKit** è®¡ç®—ä»¥ä¸‹ä¸‰ç±»ç‰¹å¾ï¼š

#### 1. QSPR æè¿°ç¬¦ï¼ˆæ¯ç§åŒ–åˆç‰©å„è®¡ç®—ä¸€ç»„ï¼‰

| ç‰¹å¾ | è¯´æ˜ |
|------|------|
| `MolWt` | ç²¾ç¡®åˆ†å­é‡ |
| `logP` | ç–æ°´æ€§ç³»æ•°ï¼ˆClogPï¼‰ |
| `TPSA` | æ‹“æ‰‘ææ€§è¡¨é¢ç§¯ |
| `LabuteASA` | Labute çº¦åŒ–è¡¨é¢ç§¯ |
| `dipole` | Crippen æè¿°ç¬¦ï¼ˆLogP ç›¸å…³ï¼‰ |

#### 2. ç«‹ä½“æè¿°ç¬¦ï¼ˆéœ€ 3D æ„è±¡ä¼˜åŒ–ï¼‰

| ç‰¹å¾ | è¯´æ˜ |
|------|------|
| `asphericity` | åˆ†å­ä¸å¯¹ç§°æ€§ |
| `eccentricity` | åˆ†å­åå¿ƒç‡ |
| `inertial_shape_factor` | æƒ¯æ€§å½¢çŠ¶å› å­ |
| `NPR1` / `NPR2` | ä¸»æƒ¯æ€§çŸ©æ¯” |
| `CalcSpherocityIndex` | çƒå½¢åº¦æŒ‡æ•° |
| `CalcRadiusOfGyration` | å›æ—‹åŠå¾„ |

#### 3. åˆ†å­æŒ‡çº¹ç›¸ä¼¼åº¦ï¼ˆåŒ–åˆç‰©å¯¹ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼‰

| ç‰¹å¾ | è¯´æ˜ |
|------|------|
| `Avalon Similarity` | Avalon æŒ‡çº¹ Tanimoto ç›¸ä¼¼åº¦ |
| `Morgan Similarity` | Morgan (ECFP) æŒ‡çº¹ Tanimoto ç›¸ä¼¼åº¦ |
| `Topological Similarity` | æ‹“æ‰‘æ‰­è½¬æŒ‡çº¹ Tanimoto ç›¸ä¼¼åº¦ |

åŠ ä¸Š `Measured at T (K)` æ¸©åº¦å’Œç›®æ ‡å€¼ `Ï‡-result`ï¼Œå…±è¾“å‡º **28 ä¸ªç‰¹å¾åˆ— + 1 ä¸ªç›®æ ‡åˆ—**ã€‚

```bash
python ç‰¹å¾å·¥ç¨‹.py
```

---

### Step 4ï¼šæ¨¡å‹è®­ç»ƒ

ç‰¹å¾å·¥ç¨‹å®Œæˆåï¼Œå¯é€šè¿‡ä¸¤ç§è·¯å¾„è¿›è¡Œå»ºæ¨¡ï¼š

#### Step 4aï¼šDNN æ·±åº¦ç¥ç»ç½‘ç»œ

**è„šæœ¬**: [`DNN.py`](DNN.py)

**åŠŸèƒ½**: ä½¿ç”¨ TensorFlow/Keras æ„å»º DNN å›å½’æ¨¡å‹é¢„æµ‹ Ï‡ å€¼ã€‚

| é…ç½®é¡¹ | å€¼ |
|--------|------|
| ç½‘ç»œç»“æ„ | 128 â†’ BN â†’ 64 â†’ 32 â†’ 16 â†’ 8 â†’ 4(L2) â†’ 1 |
| æŸå¤±å‡½æ•° | MAE |
| ä¼˜åŒ–å™¨ | Adam |
| å›è°ƒ | EarlyStopping(patience=15) + ReduceLROnPlateau |
| æ•°æ®åˆ’åˆ† | 80% è®­ç»ƒ / 20% æµ‹è¯• |
| æ ‡å‡†åŒ– | X å’Œ y å‡ä½¿ç”¨ StandardScaler |

```bash
python DNN.py
```

**è¾“å‡º**: `DNN.h5`ï¼ˆæ¨¡å‹æ–‡ä»¶ï¼‰+ è®­ç»ƒæŸå¤±æ›²çº¿å›¾

#### Step 4bï¼šSklearn ä¼ ç»Ÿæœºå™¨å­¦ä¹ 

**è„šæœ¬**: [`Sklearn.py`](Sklearn.py)

**åŠŸèƒ½**: æ‰¹é‡è®­ç»ƒå¤šç§ Sklearn å›å½’æ¨¡å‹ï¼Œä½¿ç”¨ **è´å¶æ–¯è¶…å‚æ•°ä¼˜åŒ–**ï¼ˆBayesSearchCVï¼‰æœç´¢æœ€ä¼˜å‚æ•°ï¼Œè‡ªåŠ¨é€‰å‡ºæœ€ä½³æ¨¡å‹ã€‚

| æ¨¡å‹ | æœç´¢ç©ºé—´ |
|------|----------|
| Ridge | alpha, max_iter |
| Lasso | alpha, max_iter |
| SVR | kernel, C, gamma, max_iter |
| RandomForest | n_estimators, max_depth, max_features |
| GradientBoosting | n_estimators, max_depth, max_features |

```bash
python Sklearn.py
```

**è¾“å‡º**: `fingerprint_model.pkl`ï¼ˆæœ€ä¼˜æ¨¡å‹ pickle æ–‡ä»¶ï¼‰

---

### Step 5ï¼šæ¨¡å‹éªŒè¯ä¸åˆ†æ

#### DNN æ¨¡å‹éªŒè¯

**è„šæœ¬**: [`DNN_æ¨¡å‹éªŒè¯.py`](DNN_æ¨¡å‹éªŒè¯.py)

**åŠŸèƒ½**: åŠ è½½è®­ç»ƒå¥½çš„ DNN æ¨¡å‹ï¼Œåœ¨å…¨é‡æ•°æ®ä¸Šè¿›è¡Œé¢„æµ‹ï¼Œè¾“å‡ºè¯„ä¼°æŒ‡æ ‡ï¼ˆRÂ²ã€MAEã€RMSEï¼‰å’Œé¢„æµ‹ç»“æœã€‚

æ¨¡å‹è·¯å¾„é€šè¿‡è„šæœ¬é¡¶éƒ¨çš„ `MODEL_PATH` å˜é‡é…ç½®ï¼Œé»˜è®¤ä¸º `DNN.h5`ï¼Œå¯æ›¿æ¢ä¸ºä»»æ„ `.h5` / `.keras` æ¨¡å‹æ–‡ä»¶ã€‚

```bash
python DNN_æ¨¡å‹éªŒè¯.py
```

**è¾“å‡º**: `DNN_validation_results.xlsx`ï¼ˆå«é¢„æµ‹å€¼å’Œæ®‹å·®åˆ—ï¼‰

#### Sklearn æ¨¡å‹éªŒè¯

**è„šæœ¬**: [`Sklearn_æ¨¡å‹éªŒè¯.py`](Sklearn_æ¨¡å‹éªŒè¯.py)

**åŠŸèƒ½**: åŠ è½½è®­ç»ƒå¥½çš„ Sklearn æ¨¡å‹ï¼Œåœ¨å…¨é‡æ•°æ®ä¸Šè¿›è¡Œé¢„æµ‹ï¼Œè¾“å‡ºè¯„ä¼°æŒ‡æ ‡å’Œé¢„æµ‹ç»“æœã€‚

```bash
python Sklearn_æ¨¡å‹éªŒè¯.py
```

**è¾“å‡º**: `Sklearn_validation_results.xlsx`ï¼ˆå«é¢„æµ‹å€¼å’Œæ®‹å·®åˆ—ï¼‰

### Step 6ï¼šç‰¹å¾è´¡çŒ®åˆ†æï¼ˆæ¨¡å‹å¯è§£é‡Šæ€§ï¼‰

#### DNN SHAP åˆ†æ

**è„šæœ¬**: [`DNNç‰¹å¾è´¡çŒ®åˆ†æ.py`](DNNç‰¹å¾è´¡çŒ®åˆ†æ.py)

**åŠŸèƒ½**: ä½¿ç”¨ SHAP GradientExplainer è®¡ç®—å„ç‰¹å¾å¯¹ DNN æ¨¡å‹é¢„æµ‹çš„è´¡çŒ®åº¦ï¼Œè¾“å‡º:

- å¹³å‡ç»å¯¹ SHAP å€¼æŸ±çŠ¶å›¾ï¼ˆç‰¹å¾é‡è¦æ€§æ’åºï¼‰
- å¹³å‡ SHAP å€¼æŸ±çŠ¶å›¾ï¼ˆå¸¦æ­£è´Ÿæ–¹å‘ï¼Œåæ˜ ç‰¹å¾å¯¹é¢„æµ‹çš„æ¨é«˜/æ‹‰ä½æ•ˆåº”ï¼‰

```bash
python DNNç‰¹å¾è´¡çŒ®åˆ†æ.py
```

**è¾“å‡º**: `results/DNN_SHAP_analysis.png`

#### éšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§

**è„šæœ¬**: [`RFç‰¹å¾è´¡çŒ®åˆ†æ.py`](RFç‰¹å¾è´¡çŒ®åˆ†æ.py)

**åŠŸèƒ½**: ä»è®­ç»ƒå¥½çš„ RandomForest æ¨¡å‹ä¸­æå– `feature_importances_`ï¼ŒæŒ‰é‡è¦æ€§æ’åºç»˜åˆ¶æŸ±çŠ¶å›¾ï¼Œå¹¶æ‰“å°ç‰¹å¾æ’åã€‚

```bash
python RFç‰¹å¾è´¡çŒ®åˆ†æ.py
```

**è¾“å‡º**: `results/RF_feature_importance.png`

---

## æ•°æ®æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ä½ç½® | æè¿° | äº§ç”Ÿé˜¶æ®µ |
|------|------|------|----------|
| `Huggins.xlsx` | æ ¹ç›®å½• | åŸå§‹æ•°æ®ï¼ŒåŒ…å«åŒ–åˆç‰©åç§°ã€Ï‡ å‚æ•°è¡¨è¾¾å¼ã€æ¸©åº¦ | è¾“å…¥æ•°æ® |
| `smiles_raw.csv` | `data/` | åŒ–åˆç‰©åç§° + SMILES åˆ†å­ç»“æ„ | Step 1 è¾“å‡º |
| `smiles_cleaned.xlsx` | `data/` | æ‰‹åŠ¨æ¸…æ´—åçš„ SMILES æ•°æ® | æ‰‹åŠ¨å¤„ç† |
| `huggins_preprocessed.xlsx` | `data/` | æ¸©åº¦è£‚å˜åçš„é¢„å¤„ç†æ•°æ® | Step 2 è¾“å‡º |
| `molecular_features.xlsx` | `data/` | 28ç»´åˆ†å­æè¿°ç¬¦ç‰¹å¾çŸ©é˜µ + ç›®æ ‡å€¼ | Step 3 è¾“å‡º |
| `DNN.h5` / `DNN_v2.h5` | `results/` | DNN è®­ç»ƒæ¨¡å‹ | Step 4a è¾“å‡º |
| `fingerprint_model.pkl` | `results/` | Sklearn æœ€ä¼˜æ¨¡å‹ | Step 4b è¾“å‡º |
| `DNN_validation_results.xlsx` | `results/` | DNN éªŒè¯ç»“æœï¼ˆå«é¢„æµ‹å€¼ä¸æ®‹å·®ï¼‰ | Step 5 è¾“å‡º |
| `Sklearn_validation_results.xlsx` | `results/` | Sklearn éªŒè¯ç»“æœï¼ˆå«é¢„æµ‹å€¼ä¸æ®‹å·®ï¼‰ | Step 5 è¾“å‡º |
| `DNN_SHAP_analysis.png` | `results/` | DNN SHAP ç‰¹å¾è´¡çŒ®åˆ†æå›¾ | Step 6a è¾“å‡º |
| `RF_feature_importance.png` | `results/` | éšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§å›¾ | Step 6b è¾“å‡º |

---

## å®éªŒç‰ˆæœ¬ï¼ˆæµ‹è¯•ç›®å½•ï¼‰

`æµ‹è¯•/` ç›®å½•ä¸­åŒ…å«äº†å¤šä¸ªå®éªŒæ€§ç‰ˆæœ¬ï¼Œç”¨äºæ¢ç´¢ä¸åŒæ¨¡å‹ç»“æ„å’Œä¼˜åŒ–ç­–ç•¥ï¼š

| è„šæœ¬ | è¯´æ˜ |
|------|------|
| `æµ‹è¯•/DNN.py` | DNN æ”¹è¿›ç‰ˆï¼šHuber Loss + å…¨å±‚ BN/Dropout + L2 æ­£åˆ™åŒ– + ModelCheckpoint |
| `æµ‹è¯•/DNN_v2.py` | DNN ç²¾ç®€ç‰ˆï¼šé’ˆå¯¹å°æ•°æ®é›†ä¼˜åŒ–ç½‘ç»œå®½åº¦ï¼Œå¤šæ¬¡ç§å­è®­ç»ƒå–æœ€ä¼˜ |
| `æµ‹è¯•/DNN_Map.py` | DNN è¶…å‚æ•°æœç´¢ï¼šä½¿ç”¨ GridSearchCV + KerasRegressor æœç´¢å±‚ç»“æ„å’Œå­¦ä¹ ç‡ |
| `æµ‹è¯•/Sklearn.py` | Sklearn æ‰©å±•ç‰ˆï¼šå¢åŠ  XGBoost å’Œ MLPRegressorï¼Œç»˜åˆ¶äº¤å‰éªŒè¯ç®±çº¿å›¾ |
| `æµ‹è¯•/GPR.py` | é«˜æ–¯è¿‡ç¨‹å›å½’ï¼ˆGaussian Process Regressionï¼‰æ¨¡å‹ |
| `æµ‹è¯•/DNNç‰¹å¾è´¡çŒ®åˆ†æ.py` | SHAP ç‰¹å¾é‡è¦æ€§åˆ†æï¼ˆDNN æ¨¡å‹å¯è§£é‡Šæ€§ï¼‰ |
| `æµ‹è¯•/RFç‰¹å¾è´¡çŒ®åˆ†æ.py` | éšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§æ’åºå›¾ |

---

## ä¾èµ–åˆ—è¡¨

è¯¦è§ [`requirements.txt`](requirements.txt)ï¼š

```
pandas>=1.5.0
numpy>=1.23.0
openpyxl>=3.0.0
scikit-learn>=1.1.0
scikit-optimize>=0.9.0
xgboost>=1.7.0
tensorflow>=2.10.0
matplotlib>=3.5.0
requests>=2.28.0
tqdm>=4.64.0
```

é¢å¤–ä¾èµ–ï¼ˆéœ€ conda å®‰è£…ï¼‰ï¼š

```
rdkit (conda install -c conda-forge rdkit)
shap  (pip install shap)  # ç‰¹å¾è´¡çŒ®åˆ†ææ‰€éœ€
```

---

## è¯„ä¼°æŒ‡æ ‡

æ¨¡å‹ä½¿ç”¨ä»¥ä¸‹æŒ‡æ ‡è¯„ä¼°é¢„æµ‹æ•ˆæœï¼š

| æŒ‡æ ‡ | å…¬å¼ | è¯´æ˜ |
|------|------|------|
| **RÂ²** | 1 - SS_res/SS_tot | å†³å®šç³»æ•°ï¼Œè¶Šæ¥è¿‘ 1 è¶Šå¥½ |
| **MAE** | mean(\|y_true - y_pred\|) | å¹³å‡ç»å¯¹è¯¯å·® |
| **RMSE** | âˆš(mean((y_true - y_pred)Â²)) | å‡æ–¹æ ¹è¯¯å·® |
| **MAPE** | mean(\|y_true - y_pred\|/\|y_true\|) | å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·® |

---

## å¿«é€Ÿå¼€å§‹

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd Graduation-project

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt
conda install -c conda-forge rdkit

# 3. æŒ‰é¡ºåºæ‰§è¡Œæµæ°´çº¿
python è·å–SMILES.py            # Step 1: è·å– SMILESï¼ˆéœ€ç½‘ç»œï¼‰
python æ•°æ®å¤„ç†éƒ¨åˆ†ä»£ç .py        # Step 2: æ•°æ®é¢„å¤„ç†
python ç‰¹å¾å·¥ç¨‹.py               # Step 3: ç‰¹å¾å·¥ç¨‹
python DNN.py                   # Step 4a: DNN å»ºæ¨¡
python Sklearn.py               # Step 4b: Sklearn å»ºæ¨¡
python æ¨¡å‹éªŒè¯.py               # Step 5: æ¨¡å‹éªŒè¯
```

> ğŸ’¡ å¦‚æœå·²æœ‰ `è®¡ç®—ç»“æœ.xlsx`ï¼Œå¯ç›´æ¥ä» Step 4 å¼€å§‹è¿è¡Œæ¨¡å‹è®­ç»ƒã€‚

---

## License

æœ¬é¡¹ç›®ä¸ºæ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»…ä¾›å­¦æœ¯ç ”ç©¶ä½¿ç”¨ã€‚
